NOTE: PROCEDURE PRINTTO used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

13666  
13667  * Read coefficients from our replication attempt, along with std errs.    ;
13668  * These are found starting at column #44 on lines 115-138 of slopes.txt,  ;
13669  * which is the output log from a SUDAAN run.                              ;
13670  data coef_rep;
13671    infile "&outputs/slopes.txt" firstobs=115;
13672    if _N_<=24;
13673    input @44 coef
13674        +1 stderr
13675        ;
13676  run;

NOTE: The infile "C:/Users/Anolinx/MTO/outputs/slopes.txt" is:
      Filename=C:\Users\Anolinx\MTO\outputs\slopes.txt,
      RECFM=V,LRECL=32767,File Size (bytes)=10397,
      Last Modified=02Feb2016:11:54:07,
      Create Time=02Feb2016:11:54:07

NOTE: DATA STEP stopped due to looping.
NOTE: 24 records were read from the infile "C:/Users/Anolinx/MTO/outputs/slopes.txt".
      The minimum record length was 70.
      The maximum record length was 70.
NOTE: The data set WORK.COEF_REP has 24 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

13677  
13678  * Read the coefficients of the PTSD imputation model ;
13679  * used in the 2014 JAMA paper.                       ;
13680  proc import datafile="&folder/PTSD_slopes_from_NCSR.csv"
13681       out=coef_ori
13682       dbms=csv
13683       replace;
13684       getnames=yes;
13685  run;

13686   /**********************************************************************
13687   *   PRODUCT:   SAS
13688   *   VERSION:   9.4
13689   *   CREATOR:   External File Interface
13690   *   DATE:      06MAR16
13691   *   DESC:      Generated SAS Datastep Code
13692   *   TEMPLATE SOURCE:  (None Specified.)
13693   ***********************************************************************/
13694      data WORK.COEF_ORI    ;
13695      %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
13696      infile 'C:/Users/Anolinx/MTO/PTSD_slopes_from_NCSR.csv' delimiter = ',' MISSOVER DSD
13696! lrecl=32767 firstobs=2 ;
13697         informat Independent_variable $9. ;
13698         informat Beta best32. ;
13699         informat Label $64. ;
13700         format Independent_variable $9. ;
13701         format Beta best12. ;
13702         format Label $64. ;
13703      input
13704                  Independent_variable $
13705                  Beta
13706                  Label $
13707      ;
13708      if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
13709      run;

NOTE: The infile 'C:/Users/Anolinx/MTO/PTSD_slopes_from_NCSR.csv' is:
      Filename=C:\Users\Anolinx\MTO\PTSD_slopes_from_NCSR.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=1276,
      Last Modified=02Feb2016:11:54:07,
      Create Time=02Feb2016:11:54:07

NOTE: 24 records were read from the infile 'C:/Users/Anolinx/MTO/PTSD_slopes_from_NCSR.csv'.
      The minimum record length was 14.
      The maximum record length was 78.
NOTE: The data set WORK.COEF_ORI has 24 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

24 rows created in WORK.COEF_ORI from C:/Users/Anolinx/MTO/PTSD_slopes_from_NCSR.csv.
  
  
  
NOTE: WORK.COEF_ORI data set was successfully created.
NOTE: The data set WORK.COEF_ORI has 24 observations and 3 variables.
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.22 seconds
      cpu time            0.14 seconds
      

13710  
13711  * Read the covariance matrix from original authors ;
13712  data covar_theirs;
13713    set "&folder/youth_covmatrix.sas7bdat";
NOTE: Data file WC000001.YOUTH_COVMATRIX.DATA is in a format that is native to another host, or 
      the file encoding does not match the session encoding. Cross Environment Data Access will 
      be used, which might require additional CPU resources and might reduce performance.
13714  run;

NOTE: There were 97 observations read from the data set 
      C:/Users/Anolinx/MTO/youth_covmatrix.sas7bdat.
NOTE: The data set WORK.COVAR_THEIRS has 97 observations and 33 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

13715  
13716  * Convert SUDAAN's MODCOV-type output to a SAS7BDAT format compatible ;
13717  * with the variance-covariance matrix (and parameter estimates) as    ;
13718  * received from Nancy Sampson.                                        ;
13719  data covar_ours;
13720    infile "&outputs/covmat01.dbs";
13721    * Fill in the leftmost, uninformative columns ;
13722    PROCNUM = .;
13723    MODELNO = .;
13724    NCELL   = .;
13725    EST_ID  = .;
13726    IDNUM   = .;
13727    ROWNUM  = .;
13728    DDF     = .;
13729    CHECK   = .;
13730    RANK    = .;
13731    * Load the substantive content ;
13732    input Intercept 25-38 Age SEXF RHISP RBLK ROTH
13733          PT41 PT42 PT43 PT44 PT45 PT46 PT48 PT50 PT50_1 PT51 PT55
13734          PT209 PT211 PT212 PT213 PT214 PT233 PT237
13735          ;
13736  run;

NOTE: The infile "C:/Users/Anolinx/MTO/outputs/covmat01.dbs" is:
      Filename=C:\Users\Anolinx\MTO\outputs\covmat01.dbs,
      RECFM=V,LRECL=32767,File Size (bytes)=35114,
      Last Modified=02Feb2016:11:54:07,
      Create Time=02Feb2016:11:54:07

NOTE: 97 records were read from the infile "C:/Users/Anolinx/MTO/outputs/covmat01.dbs".
      The minimum record length was 360.
      The maximum record length was 360.
NOTE: The data set WORK.COVAR_OURS has 97 observations and 33 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

13737  
13738  * As a check, we print our respective covariance matrices,  ;
13739  * and compare them by several rough methods.                ;
13740  proc iml;
NOTE: IML Ready
13741    * (A) Read 'ours' into IML matrices/vectors ;
13742    use covar_ours;
13743    read all var _num_ into our_cov[colname=CovarNames];
13744    close covar_ours;
13745    CovarNames=CovarNames[10:33];
13746    our_beta = our_cov[25,10:33];
13746!                                 * The 25th row is our_beta ;
13747    print our_beta[Label="Our betas, now taken from row #25 of covariance matrix"
13748     colname=CovarNames];
13749    our_cov = our_cov[1:24,10:33];
13749!                                  * Top right 24x24 matrix is truly our_cov ;
13750    print our_cov[Label="Covariance matrix from our SUDAAN-estimated PTSD imputation model"
13751     colname=CovarNames rowname=CovarNames];
13752    * (B) Read 'theirs' into IML matrices/vectors ;
13753    use covar_theirs;
13754    read all var _num_ into their_cov;
13754!                                      * ignore their colnames B001-B024 ;
13755    close covar_theirs;
13756    their_beta = their_cov[25,10:33];
13756!                                     * The 25th row is their_beta ;
13757    print their_beta[Label="Their betas, now taken from row #25 of covariance matrix"
13758     colname=CovarNames];
13759    their_cov = their_cov[1:24,10:33];
13759!                                      * Top right 24x24 matrix is truly their_cov ;
13760    print their_cov[Label="Covariance matrix from their PROC RLOGIST PTSD imputation model"
13761     colname=CovarNames rowname=CovarNames];
13762    * (C) Ours-vs-theirs covariance matrix comparisons ;
13763    maxdiff = max(abs(vecdiag(our_cov) - vecdiag(their_cov)));
13764    print maxdiff[Label="Largest abs diff between our cov diagonal and theirs"];
13765    * TODO: Compare sum of squared errors? ;
13766    ss_diffs = sum((our_cov - their_cov)##2);
13767    ss_elems = sum(their_cov##2);
13768    R2 = 1.0 - (ss_diffs/ss_elems);
13769    print R2[Label="Fraction of 'variation' in their covar terms explained by ours"];
13770    store our_cov our_beta their_cov their_beta CovarNames;
NOTE: Opening storage library WORK.IMLSTOR
13771  run;
NOTE: Module MAIN is undefined in IML; cannot be RUN.
13772  
13773  * Tabulate our replicated PTSD imputation coefficients for comparison ;
13774  * with those used in the 2014 JAMA paper.                             ;
NOTE: Exiting IML.
NOTE: Storage library WORK.IMLSTOR closed.
NOTE: PROCEDURE IML used (Total process time):
      real time           0.05 seconds
      cpu time            0.06 seconds
      

13775  proc iml;
NOTE: IML Ready
13776    load our_cov our_beta their_cov their_beta;
NOTE: Opening storage library WORK.IMLSTOR
13777    their_stderr = sqrt(vecdiag(their_cov)`);
13778    * Load some of the niceties (esp., *labels*) from the CSV;
13779    use coef_ori;
13780    *read all var "Beta" into their_beta[rowname=Independent_variable];
13781    read all var "Independent_variable" into rhs_vars[rowname=Label];
13782    read all var "Label" into var_detail[rowname=Independent_variable];
13783    close coef_ori;
13784    diff_in_stderrs = (their_beta - our_beta)/their_stderr;
13785    create betas var {rhs_vars our_beta their_beta their_stderr diff_in_stderrs var_detail};
13786    append var {rhs_vars our_beta their_beta their_stderr diff_in_stderrs var_detail};
13787  run;
NOTE: Module MAIN is undefined in IML; cannot be RUN.
13788  
13789  ods pdf file = "&outputs/RS3-Betas_Compared.pdf";
NOTE: Writing ODS PDF output to DISK destination 
      "C:\Users\Anolinx\MTO\outputs\RS3-Betas_Compared.pdf", printer "PDF".
NOTE: Exiting IML.
NOTE: The data set WORK.BETAS has 24 observations and 6 variables.
NOTE: Storage library WORK.IMLSTOR closed.
NOTE: PROCEDURE IML used (Total process time):
      real time           0.12 seconds
      cpu time            0.09 seconds
      

13790  proc print data=betas;
13791    title1 'Comparison of original PTSD imputation model betas with our reproduction attempt'
13791! ;
13792  run;

NOTE: There were 24 observations read from the data set WORK.BETAS.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

13793  ods pdf close;
NOTE: ODS PDF printed 1 page to C:\Users\Anolinx\MTO\outputs\RS3-Betas_Compared.pdf.
13794  /* end of STEP III */
13795  
13796  /*  STEP IV -- Prepare the MTO data
13797   ***********************************/
13798   *       add/remove forward slash --^ ;
13799   *       to enable/disable STEP IV    ;
13800  
13801  PROC PRINTTO NEW
13802    LOG="&outputs/RS4.log";
13803  RUN;

