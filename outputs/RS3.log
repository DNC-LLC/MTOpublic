NOTE: PROCEDURE PRINTTO used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1015  
1016  * Read coefficients from our replication attempt, along with std errs.    ;
1017  * These are found starting at column #44 on lines 115-138 of slopes.txt,  ;
1018  * which is the output log from a SUDAAN run.                              ;
1019  data coef_rep;
1020    infile "&outputs/slopes.txt" firstobs=115;
1021    if _N_<=24;
1022    input @44 coef
1023        +1 stderr
1024        ;
1025  run;

NOTE: The infile "C:/Users/Anolinx/MTO/outputs/slopes.txt" is:
      Filename=C:\Users\Anolinx\MTO\outputs\slopes.txt,
      RECFM=V,LRECL=32767,File Size (bytes)=10397,
      Last Modified=02Feb2016:11:54:07,
      Create Time=02Feb2016:11:54:07

NOTE: DATA STEP stopped due to looping.
NOTE: 24 records were read from the infile "C:/Users/Anolinx/MTO/outputs/slopes.txt".
      The minimum record length was 70.
      The maximum record length was 70.
NOTE: The data set WORK.COEF_REP has 24 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1026  
1027  * Read the coefficients of the PTSD imputation model ;
1028  * used in the 2014 JAMA paper.                       ;
1029  proc import datafile="&folder/PTSD_slopes_from_NCSR.csv"
1030       out=coef_ori
1031       dbms=csv
1032       replace;
1033       getnames=yes;
1034  run;

1035   /**********************************************************************
1036   *   PRODUCT:   SAS
1037   *   VERSION:   9.4
1038   *   CREATOR:   External File Interface
1039   *   DATE:      06MAR16
1040   *   DESC:      Generated SAS Datastep Code
1041   *   TEMPLATE SOURCE:  (None Specified.)
1042   ***********************************************************************/
1043      data WORK.COEF_ORI    ;
1044      %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
1045      infile 'C:/Users/Anolinx/MTO/PTSD_slopes_from_NCSR.csv' delimiter = ',' MISSOVER DSD
1045! lrecl=32767 firstobs=2 ;
1046         informat Independent_variable $9. ;
1047         informat Beta best32. ;
1048         informat Label $64. ;
1049         format Independent_variable $9. ;
1050         format Beta best12. ;
1051         format Label $64. ;
1052      input
1053                  Independent_variable $
1054                  Beta
1055                  Label $
1056      ;
1057      if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
1058      run;

NOTE: The infile 'C:/Users/Anolinx/MTO/PTSD_slopes_from_NCSR.csv' is:
      Filename=C:\Users\Anolinx\MTO\PTSD_slopes_from_NCSR.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=1276,
      Last Modified=02Feb2016:11:54:07,
      Create Time=02Feb2016:11:54:07

NOTE: 24 records were read from the infile 'C:/Users/Anolinx/MTO/PTSD_slopes_from_NCSR.csv'.
      The minimum record length was 14.
      The maximum record length was 78.
NOTE: The data set WORK.COEF_ORI has 24 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

24 rows created in WORK.COEF_ORI from C:/Users/Anolinx/MTO/PTSD_slopes_from_NCSR.csv.
  
  
  
NOTE: WORK.COEF_ORI data set was successfully created.
NOTE: The data set WORK.COEF_ORI has 24 observations and 3 variables.
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds
      

1059  
1060  * Read the covariance matrix from original authors ;
1061  data covar_theirs;
1062    set "&folder/youth_covmatrix.sas7bdat";
NOTE: Data file WC000001.YOUTH_COVMATRIX.DATA is in a format that is native to another host, or 
      the file encoding does not match the session encoding. Cross Environment Data Access will 
      be used, which might require additional CPU resources and might reduce performance.
1063  run;

NOTE: There were 97 observations read from the data set 
      C:/Users/Anolinx/MTO/youth_covmatrix.sas7bdat.
NOTE: The data set WORK.COVAR_THEIRS has 97 observations and 33 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

1064  
1065  * Convert SUDAAN's MODCOV-type output to a SAS7BDAT format compatible ;
1066  * with the variance-covariance matrix (and parameter estimates) as    ;
1067  * received from Nancy Sampson.                                        ;
1068  data covar_ours;
1069    infile "&outputs/covmat01.dbs";
1070    * Fill in the leftmost, uninformative columns ;
1071    PROCNUM = .;
1072    MODELNO = .;
1073    NCELL   = .;
1074    EST_ID  = .;
1075    IDNUM   = .;
1076    ROWNUM  = .;
1077    DDF     = .;
1078    CHECK   = .;
1079    RANK    = .;
1080    * Load the substantive content ;
1081    input Intercept 25-38 Age SEXF RHISP RBLK ROTH
1082          PT41 PT42 PT43 PT44 PT45 PT46 PT48 PT50 PT50_1 PT51 PT55
1083          PT209 PT211 PT212 PT213 PT214 PT233 PT237
1084          ;
1085  run;

NOTE: The infile "C:/Users/Anolinx/MTO/outputs/covmat01.dbs" is:
      Filename=C:\Users\Anolinx\MTO\outputs\covmat01.dbs,
      RECFM=V,LRECL=32767,File Size (bytes)=35114,
      Last Modified=02Feb2016:11:54:07,
      Create Time=02Feb2016:11:54:07

NOTE: 97 records were read from the infile "C:/Users/Anolinx/MTO/outputs/covmat01.dbs".
      The minimum record length was 360.
      The maximum record length was 360.
NOTE: The data set WORK.COVAR_OURS has 97 observations and 33 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1086  
1087  * As a check, we print our respective covariance matrices,  ;
1088  * and compare them by several rough methods.                ;
1089  proc iml;
NOTE: IML Ready
1090    * (A) Read 'ours' into IML matrices/vectors ;
1091    use covar_ours;
1092    read all var _num_ into our_cov[colname=CovarNames];
1093    close covar_ours;
1094    CovarNames=CovarNames[10:33];
1095    our_beta = our_cov[25,10:33];
1095!                                 * The 25th row is our_beta ;
1096    print our_beta[Label="Our betas, now taken from row #25 of covariance matrix"
1097     colname=CovarNames];
1098    our_cov = our_cov[1:24,10:33];
1098!                                  * Top right 24x24 matrix is truly our_cov ;
1099    print our_cov[Label="Covariance matrix from our SUDAAN-estimated PTSD imputation model"
1100     colname=CovarNames rowname=CovarNames];
1101    * (B) Read 'theirs' into IML matrices/vectors ;
1102    use covar_theirs;
1103    read all var _num_ into their_cov;
1103!                                      * ignore their colnames B001-B024 ;
1104    close covar_theirs;
1105    their_beta = their_cov[25,10:33];
1105!                                     * The 25th row is their_beta ;
1106    print their_beta[Label="Their betas, now taken from row #25 of covariance matrix"
1107     colname=CovarNames];
1108    their_cov = their_cov[1:24,10:33];
1108!                                      * Top right 24x24 matrix is truly their_cov ;
1109    print their_cov[Label="Covariance matrix from their PROC RLOGIST PTSD imputation model"
1110     colname=CovarNames rowname=CovarNames];
1111    * (C) Ours-vs-theirs covariance matrix comparisons ;
1112    maxdiff = max(abs(vecdiag(our_cov) - vecdiag(their_cov)));
1113    print maxdiff[Label="Largest abs diff between our cov diagonal and theirs"];
1114    * TODO: Compare sum of squared errors? ;
1115    ss_diffs = sum((our_cov - their_cov)##2);
1116    ss_elems = sum(their_cov##2);
1117    R2 = 1.0 - (ss_diffs/ss_elems);
1118    print R2[Label="Fraction of 'variation' in their covar terms explained by ours"];
1119    store our_cov our_beta their_cov their_beta CovarNames;
NOTE: Opening storage library WORK.IMLSTOR
1120  run;
NOTE: Module MAIN is undefined in IML; cannot be RUN.
1121  
1122  * Tabulate our replicated PTSD imputation coefficients for comparison ;
1123  * with those used in the 2014 JAMA paper.                             ;
NOTE: Exiting IML.
NOTE: Storage library WORK.IMLSTOR closed.
NOTE: PROCEDURE IML used (Total process time):
      real time           0.05 seconds
      cpu time            0.04 seconds
      

1124  proc iml;
NOTE: IML Ready
1125    load our_cov our_beta their_cov their_beta;
NOTE: Opening storage library WORK.IMLSTOR
1126    their_stderr = sqrt(vecdiag(their_cov)`);
1127    * Load some of the niceties (esp., *labels*) from the CSV;
1128    use coef_ori;
1129    *read all var "Beta" into their_beta[rowname=Independent_variable];
1130    read all var "Independent_variable" into rhs_vars[rowname=Label];
1131    read all var "Label" into var_detail[rowname=Independent_variable];
1132    close coef_ori;
1133    diff_in_stderrs = (their_beta - our_beta)/their_stderr;
1134    create betas var {rhs_vars our_beta their_beta their_stderr diff_in_stderrs var_detail};
1135    append var {rhs_vars our_beta their_beta their_stderr diff_in_stderrs var_detail};
1136  run;
NOTE: Module MAIN is undefined in IML; cannot be RUN.
1137  
1138  ods pdf file = "&outputs/RS3-Betas_Compared.pdf";
NOTE: Writing ODS PDF output to DISK destination 
      "C:\Users\Anolinx\MTO\outputs\RS3-Betas_Compared.pdf", printer "PDF".
NOTE: Exiting IML.
NOTE: The data set WORK.BETAS has 24 observations and 6 variables.
NOTE: Storage library WORK.IMLSTOR closed.
NOTE: PROCEDURE IML used (Total process time):
      real time           0.10 seconds
      cpu time            0.07 seconds
      

1139  proc print data=betas;
1140    title1 'Comparison of original PTSD imputation model betas with our reproduction attempt';
1141  run;

NOTE: There were 24 observations read from the data set WORK.BETAS.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

1142  ods pdf close;
NOTE: ODS PDF printed 1 page to C:\Users\Anolinx\MTO\outputs\RS3-Betas_Compared.pdf.
1143  /* end of STEP III */
1144  
1145  /*  STEP IV -- Prepare the MTO data
1146   ***********************************/
1147   *       add/remove forward slash --^ ;
1148   *       to enable/disable STEP IV    ;
1149  
1150  PROC PRINTTO NEW
1151    LOG="&outputs/RS4.log";
1152  RUN;

